<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VoucherHub - Painel Admin</title>
    <style>
        body { font-family: sans-serif; max-width: 500px; margin: 50px auto; padding: 20px; border: 1px solid #ccc; border-radius: 8px; background-color: #f9f9f9; }
        h2 { color: #333; text-align: center; }
        label { font-size: 12px; color: #666; font-weight: bold; }
        input, button { width: 100%; padding: 12px; margin: 8px 0 20px 0; display: block; box-sizing: border-box; border-radius: 4px; border: 1px solid #ddd; }
        button { background: #6772e5; color: white; border: none; cursor: pointer; font-weight: bold; font-size: 16px; margin-top: 10px; }
        button:hover { background: #5469d4; }
        .result { margin-top: 20px; padding: 15px; background: #e7f3ff; border: 1px solid #b2d7ff; border-radius: 4px; display: none; word-break: break-all; }
    </style>

</head>
<body>
    <h2>üöÄ Gerador de Parceiros</h2>
    
    <form id="adminForm">
        <label>NOME DO PARCEIRO</label>
        <input type="text" id="name" placeholder="Ex: Surf Wave Lisbon" required>
        
        <label>SLUG (√önico, sem espa√ßos)</label>
        <input type="text" id="slug" placeholder="Ex: surf-wave-lisbon" required>
        
        <label>EMAIL DO PARCEIRO</label>
        <input type="email" id="email" placeholder="email@parceiro.com" required>
        
        <label>LOCALIZA√á√ÉO</label>
        <input type="text" id="location" placeholder="Ex: Costa da Caparica">
        
        <label>PRE√áO ORIGINAL (C√™ntimos: 3000 = 30‚Ç¨)</label>
        <input type="number" id="price" placeholder="3000">

        <button type="submit" id="btn">Criar Parceiro e Gerar Link</button>
    </form>

    <div id="result" class="result"></div>

    <script>
        document.getElementById('adminForm').onsubmit = async (e) => {
            e.preventDefault();
            
            const btn = document.getElementById('btn');
            const resDiv = document.getElementById('result');
            
            btn.innerText = "‚è≥ Processando...";
            btn.disabled = true;
            resDiv.style.display = 'none';

            const data = {
                name: document.getElementById('name').value,
                slug: document.getElementById('slug').value,
                email: document.getElementById('email').value,
                location: document.getElementById('location').value,
                price_cents: document.getElementById('price').value
            };

            try {
                // LEMBRE-SE: Use a URL do seu backend na Railway aqui
                const response = await fetch('https://voucherhub-backend-production.up.railway.app/api/admin/setup-partner', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                
                const res = await response.json();
                
                if (res.success) {
                    resDiv.style.display = 'block';
                    resDiv.innerHTML = `
                        <p style="color:#2d5a27; font-weight:bold;">‚úÖ Sucesso!</p>
                        <p><b>PIN Gerado:</b> <span style="font-size:18px; color:blue;">${res.pin_gerado}</span></p>
                        <p><b>Link Stripe:</b><br>
                           <a href="${res.onboarding_url}" target="_blank" style="color:#6772e5;">Abrir Cadastro Stripe</a>
                        </p>
                    `;
                } else {
                    alert("‚ùå Erro: " + (res.error || "Falha no servidor"));
                }
            } catch (err) {
                alert("‚ùå Erro de conex√£o.");
            } finally {
                btn.innerText = "Criar Parceiro e Gerar Link";
                btn.disabled = false;
            }
        };
    </script>
</body>
</html>